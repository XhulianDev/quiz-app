const physicsQuestions = [
  { title: "Pyetja 1", text: "Çfarë është F = ma?", answers: ["Ligji i Njutonit", "Ekuacioni i Ajnshtajnit"], correct: "Ligji i Njutonit" },
  { title: "Pyetja 2", text: "Kush e zbuloi gravitetin?", answers: ["Njutoni", "Ajnshtajni"], correct: "Njutoni" },
  { title: "Pyetja 3", text: "Çfarë matet me m/s²?", answers: ["Nxitimi", "Shpejtësia"], correct: "Nxitimi" },
  { title: "Pyetja 4", text: "Cila është shpejtësia e dritës në vakum?", answers: ["150,000 km/s", "300,000 km/s"], correct: "300,000 km/s" },
  { title: "Pyetja 5", text: "Çfarë është energjia potenciale?", answers: ["Energji nga lëvizja", "Energji nga pozicioni"], correct: "Energji nga pozicioni" },
  { title: "Pyetja 6", text: "Kush e zhvilloi teorinë e relativitetit?", answers: ["Ajnshtajni", "Galileu"], correct: "Ajnshtajni" }
];

const biologyQuestions = [
  { title: "Pyetja 1", text: "Cila është molekula që bart informacionin gjenetik?", answers: ["ADN", "ARN"], correct: "ADN" },
  { title: "Pyetja 2", text: "Cili organ pompon gjakun në trup?", answers: ["Mushkëritë", "Zemra"], correct: "Zemra" },
  { title: "Pyetja 3", text: "Çfarë procesi përdorin bimët për të prodhuar ushqim?", answers: ["Fotosinteza", "Frymëmarrja"], correct: "Fotosinteza" },
  { title: "Pyetja 4", text: "Cili është sistemi që kontrollon hormonet?", answers: ["Nervor", "Endokrin"], correct: "Endokrin" },
  { title: "Pyetja 5", text: "Cila është qeliza më e vogël në trupin e njeriut?", answers: ["Spermatozoidi", "Neuroni"], correct: "Spermatozoidi" },
  { title: "Pyetja 6", text: "Cili organizëm është i aftë të ndryshojë ngjyrë për t’u kamufluar?", answers: ["Peshku kloun", "Kameleoni"], correct: "Kameleoni" }
];

const geographyQuestions = [
  { title: "Pyetja 1", text: "Cili është mali më i lartë në Ballkan?", answers: ["Olimpi", "Musala"], correct: "Musala" },
  { title: "Pyetja 2", text: "Cili qytet shqiptar ndodhet më afër Detit Adriatik?", answers: ["Shkodra", "Durrësi"], correct: "Durrësi" },
  { title: "Pyetja 3", text: "Cili është lumi më i gjatë në Evropë?", answers: ["Danubi", "Volga"], correct: "Volga" },
  { title: "Pyetja 4", text: "Cili është kryeqyteti i Islandës?", answers: ["Rejkjaviku", "Oslo"], correct: "Rejkjaviku" },
  { title: "Pyetja 5", text: "Cili vend nordik është i famshëm për shfaqjen e Aurorës Boreale pranë Qarkut Arktik?", answers: ["Danimarka", "Norvegjia"], correct: "Norvegjia" },
  { title: "Pyetja 6", text: "Cili është oqeani më i madh në botë?", answers: ["Oqeani Paqësor", "Oqeani Atlantik"], correct: "Oqeani Paqësor" }
];

const historyQuestions = [
  { title: "Pyetja 1", text: "Cili udhëheqës shqiptar u quajt 'Atleti i Krishtërimit'?", answers: ["Gjergj Kastrioti Skënderbeu", "Ali Pashë Tepelena"], correct: "Gjergj Kastrioti Skënderbeu" },
  { title: "Pyetja 2", text: "Cila ngjarje në 1789 shënoi fillimin e Revolucionit Francez?", answers: ["Rënia e Bastijës", "Traktati i Versajës"], correct: "Rënia e Bastijës" },
  { title: "Pyetja 3", text: "Kush ishte perandori që kurorëzoi veten në 1804 si Napoleon I?", answers: ["Luigji XVI", "Napoleon Bonaparte"], correct: "Napoleon Bonaparte" },
  { title: "Pyetja 4", text: "Cila luftë midis 1337 dhe 1453 u zhvillua kryesisht mes Anglisë dhe Francës?", answers: ["Lufta Tridhjetëvjeçare", "Lufta Njëqindvjeçare"], correct: "Lufta Njëqindvjeçare" },
  { title: "Pyetja 5", text: "Cili traktat në 1648 i dha fund Luftës Tridhjetëvjeçare në Evropë?", answers: ["Traktati i Vestfalisë", "Traktati i Tordesillas"], correct: "Traktati i Vestfalisë" },
  { title: "Pyetja 6", text: "Kush udhëhoqi Anglinë gjatë Luftës së Dytë Botërore si kryeministër?", answers: ["Neville Chamberlain", "Winston Churchill"], correct: "Winston Churchill" }
];

const psychologyQuestions = [
  { title: "Pyetja 1", text: "Kush zhvilloi teorinë e psikoanalizës?", answers: ["Sigmund Freud", "Carl Jung"], correct: "Sigmund Freud" },
  { title: "Pyetja 2", text: "Çfarë studion psikologjia kognitive?", answers: ["Proceset mendore", "Sjelljen shoqërore"], correct: "Proceset mendore" },
  { title: "Pyetja 3", text: "Cili term përshkruan frikën irracionale nga diçka?", answers: ["Anksietet", "Fobi"], correct: "Fobi" },
  { title: "Pyetja 4", text: "Kush studioi refleksin e kushtëzuar te qentë?", answers: ["John Watson", "Ivan Pavlov"], correct: "Ivan Pavlov" },
  { title: "Pyetja 5", text: "Çfarë është ‘efekti i spektatorit’?", answers: ["Mosndihma në emergjencë", "Motivimi në grup"], correct: "Mosndihma në emergjencë" },
  { title: "Pyetja 6", text: "Cila është faza e fundit e zhvillimit sipas Eriksonit?", answers: ["Intimitet vs Izolim", "Integritet vs Dëshpërim"], correct: "Integritet vs Dëshpërim" }
];

const anthropologyQuestions = [
  { title: "Pyetja 1", text: "Cila është shkenca që studion evolucionin kulturor?", answers: ["Antropologji", "Sociologji"], correct: "Antropologji" },
  { title: "Pyetja 2", text: "Kush quhet ‘babai i antropologjisë moderne’?", answers: ["Claude Lévi-Strauss", "Franz Boas"], correct: "Franz Boas" },
  { title: "Pyetja 3", text: "Çfarë studion antropologjia fizike?", answers: ["Ritualet kulturore", "Evolucionin biologjik"], correct: "Evolucionin biologjik" },
  { title: "Pyetja 4", text: "Cili term përshkruan studimin e gjuhëve në kultura?", answers: ["Etnolinguistikë", "Arkeologji"], correct: "Etnolinguistikë" },
  { title: "Pyetja 5", text: "Cila kulturë ndërtoi Machu Picchu?", answers: ["Aztek", "Inka"], correct: "Inka" },
  { title: "Pyetja 6", text: "Çfarë është një totem në kulturat indigjene?", answers: ["Mjet bujqësor", "Simbol shpirtëror"], correct: "Simbol shpirtëror" }
];

const literatureQuestions = [
  { title: "Pyetja 1", text: "Kush është autori i 'Lahuta e Malcis'?", answers: ["Naim Frashëri", "Gjergj Fishta"], correct: "Gjergj Fishta" },
  { title: "Pyetja 2", text: "Cila është vepra më e famshme e Shekspirit?", answers: ["Don Kishoti", "Hamleti"], correct: "Hamleti" },
  { title: "Pyetja 3", text: "Kush shkroi 'Këngët e Milosaos'?", answers: ["Jeronim de Rada", "Migjeni"], correct: "Jeronim de Rada" },
  { title: "Pyetja 4", text: "Në cilin shekull u shkrua 'Divine Comedy' nga Dante?", answers: ["XVII", "XIV"], correct: "XIV" },
  { title: "Pyetja 5", text: "Cili poet shqiptar quhet 'Poeti i Mërgimit'?", answers: ["Fan Noli", "Migjeni"], correct: "Migjeni" },
  { title: "Pyetja 6", text: "Cila vepër e Homerit tregon luftën e Trojës?", answers: ["Iliada", "Odisea"], correct: "Iliada" }
];

const philosophyQuestions = [
  { title: "Pyetja 1", text: "Kush tha ‘Unë di që nuk di asgjë’?", answers: ["Sokrati", "Platoni"], correct: "Sokrati" },
  { title: "Pyetja 2", text: "Cila është vepra kryesore e Aristotelit për etikën?", answers: ["Etika Nikomake", "Politika"], correct: "Etika Nikomake" },
  { title: "Pyetja 3", text: "Kush propozoi idenë e ‘kontratës sociale’?", answers: ["Kant", "Rousseau"], correct: "Rousseau" },
  { title: "Pyetja 4", text: "Çfarë studion metafizika?", answers: ["Realitetin ultim", "Njohjen"], correct: "Realitetin ultim" },
  { title: "Pyetja 5", text: "Kush shkroi ‘Kështu foli Zarathustra’?", answers: ["Hegel", "Nietzsche"], correct: "Nietzsche" },
  { title: "Pyetja 6", text: "Cila filozofi thekson absurditetin e jetës?", answers: ["Stoicizmi", "Ekzistencializmi"], correct: "Ekzistencializmi" }
];

const visualArtsQuestions = [
  { title: "Pyetja 1", text: "Kush krijoi statujën e Davidit?", answers: ["Donatello", "Mikelandxhelo"], correct: "Mikelandxhelo" },
  { title: "Pyetja 2", text: "Cila pikturë e Van Gogh tregon një natë me yje?", answers: ["Luledielli", "Nata me Yje"], correct: "Nata me Yje" },
  { title: "Pyetja 3", text: "Kush pikturoi Mona Lizën?", answers: ["Leonardo da Vinçi", "Rafael"], correct: "Leonardo da Vinçi" },
  { title: "Pyetja 4", text: "Cili stil artistik përdori kubet dhe format gjeometrike?", answers: ["Kubizmi", "Impresionizmi"], correct: "Kubizmi" },
  { title: "Pyetja 5", text: "Cila katedrale gotike është e famshme në Paris?", answers: ["Sainte-Chapelle", "Notre-Dame"], correct: "Notre-Dame" },
  { title: "Pyetja 6", text: "Kush krijoi pikturën ‘Guernica’?", answers: ["Pablo Pikaso", "Salvador Dali"], correct: "Pablo Pikaso" }
];

let currentQuestion = 0;
let score = 0;
let currentQuestions = physicsQuestions;

document.addEventListener("DOMContentLoaded", () => {
  const keys = [
    "physicsPercentage",
    "biologyPercentage",
    "geographyPercentage",
    "historyPercentage",
    "psychologyPercentage",
    "anthropologyPercentage",
    "literaturePercentage",
    "philosophyPercentage",
    "visualArtsPercentage"
  ];
  keys.forEach(key => sessionStorage.removeItem(key));
  updateScoresDisplay();
});

function updateScoreDisplay() {
  const scoreDisplay = document.getElementById("score");
  scoreDisplay.textContent = `Pikët: ${score}`;
}

function updateScoresDisplay() {
  const subjects = [
    { name: "Fizikë", key: "physicsPercentage" },
    { name: "Biologji", key: "biologyPercentage" },
    { name: "Gjeografi", key: "geographyPercentage" },
    { name: "Histori", key: "historyPercentage" },
    { name: "Psikologji", key: "psychologyPercentage" },
    { name: "Antropologji", key: "anthropologyPercentage" },
    { name: "Letërsi", key: "literaturePercentage" },
    { name: "Filozofi", key: "philosophyPercentage" },
    { name: "Arte Vizuale", key: "visualArtsPercentage" }
  ];
  let hasResults = false;
  let scoresList = "<ul>";
  subjects.forEach(subject => {
    let percentage = sessionStorage.getItem(subject.key);
    if (percentage) {
      hasResults = true;
      const className = parseFloat(percentage) >= 50 ? "pass" : "fail";
      scoresList += `<li class="${className}">${subject.name}: ${percentage}%</li>`;
    }
  });
  scoresList += "</ul>";
  document.getElementById("scores-display").innerHTML = hasResults ? `<h4>Arritjet:</h4>${scoresList}` : "";
}

function showQuestion(index, questions) {
  const questionZone = document.getElementById("question-zone");
  const questionTitle = questionZone.querySelector("h2");
  const questionText = questionZone.querySelector("p");
  const button1 = document.getElementById("b1");
  const button2 = document.getElementById("b2");
  const correctAnswer = document.getElementById("answer");

  questionTitle.textContent = questions[index].title;
  questionText.textContent = questions[index].text;
  button1.textContent = questions[index].answers[0];
  button2.textContent = questions[index].answers[1];
  button1.dataset.answer = questions[index].answers[0];
  button2.dataset.answer = questions[index].answers[1];
  correctAnswer.textContent = "";
  updateScoreDisplay();
  button1.disabled = false;
  button2.disabled = false;
}

function startOver() {
  currentQuestion = 0;
  score = 0;
  const topicZone = document.getElementById("topic-zone");
  const resultZone = document.getElementById("result-zone");
  resultZone.style.display = "none";
  topicZone.style.display = "block";
  updateScoreDisplay();
  updateScoresDisplay();
}

function startQuiz(questions) {
  document.getElementById("topic-zone").style.display = "none";
  document.getElementById("question-zone").style.display = "block";
  currentQuestion = 0;
  score = 0;
  currentQuestions = questions;
  showQuestion(currentQuestion, currentQuestions);
}

const button1 = document.getElementById("b1");
const button2 = document.getElementById("b2");
const correctAnswer = document.getElementById("answer");

button1.addEventListener("click", () => {
  if (button1.dataset.answer === currentQuestions[currentQuestion].correct) {
    correctAnswer.textContent = "Saktë!";
    correctAnswer.style.color = "#007015";
    score++;
    updateScoreDisplay();
  } else {
    correctAnswer.textContent = "Gabim!";
    correctAnswer.style.color = "#cc0a11";
  }
  button1.disabled = true;
  button2.disabled = true;
  if (currentQuestion < currentQuestions.length - 1) {
    currentQuestion++;
    setTimeout(() => showQuestion(currentQuestion, currentQuestions), 1000);
  } else {
    setTimeout(() => {
      document.getElementById("question-zone").style.display = "none";
      document.getElementById("result-zone").style.display = "block";
      let percentage = (score / currentQuestions.length) * 100;
      let subjectKey = currentQuestions === physicsQuestions ? "physicsPercentage" :
                       currentQuestions === biologyQuestions ? "biologyPercentage" :
                       currentQuestions === geographyQuestions ? "geographyPercentage" :
                       currentQuestions === historyQuestions ? "historyPercentage" :
                       currentQuestions === psychologyQuestions ? "psychologyPercentage" :
                       currentQuestions === anthropologyQuestions ? "anthropologyPercentage" :
                       currentQuestions === literatureQuestions ? "literaturePercentage" :
                       currentQuestions === philosophyQuestions ? "philosophyPercentage" :
                       currentQuestions === visualArtsQuestions ? "visualArtsPercentage" : "";
      sessionStorage.setItem(subjectKey, percentage.toFixed(2));
      const resultMessage = document.getElementById("result-message");
      resultMessage.textContent = `Kuizi mbaroi! Pikët: ${score}/${currentQuestions.length} (${percentage.toFixed(2)}%)`;
      resultMessage.className = percentage >= 50 ? "pass" : "fail";
    }, 1000);
  }
});

button2.addEventListener("click", () => {
  if (button2.dataset.answer === currentQuestions[currentQuestion].correct) {
    correctAnswer.textContent = "Saktë!";
    correctAnswer.style.color = "#007015";
    score++;
    updateScoreDisplay();
  } else {
    correctAnswer.textContent = "Gabim!";
    correctAnswer.style.color = "#cc0a11";
  }
  button1.disabled = true;
  button2.disabled = true;
  if (currentQuestion < currentQuestions.length - 1) {
    currentQuestion++;
    setTimeout(() => showQuestion(currentQuestion, currentQuestions), 1000);
  } else {
    setTimeout(() => {
      document.getElementById("question-zone").style.display = "none";
      document.getElementById("result-zone").style.display = "block";
      let percentage = (score / currentQuestions.length) * 100;
      let subjectKey = currentQuestions === physicsQuestions ? "physicsPercentage" :
                       currentQuestions === biologyQuestions ? "biologyPercentage" :
                       currentQuestions === geographyQuestions ? "geographyPercentage" :
                       currentQuestions === historyQuestions ? "historyPercentage" :
                       currentQuestions === psychologyQuestions ? "psychologyPercentage" :
                       currentQuestions === anthropologyQuestions ? "anthropologyPercentage" :
                       currentQuestions === literatureQuestions ? "literaturePercentage" :
                       currentQuestions === philosophyQuestions ? "philosophyPercentage" :
                       currentQuestions === visualArtsQuestions ? "visualArtsPercentage" : "";
      sessionStorage.setItem(subjectKey, percentage.toFixed(2));
      const resultMessage = document.getElementById("result-message");
      resultMessage.textContent = `Kuizi mbaroi! Pikët: ${score}/${currentQuestions.length} (${percentage.toFixed(2)}%)`;
      resultMessage.className = percentage >= 50 ? "pass" : "fail";
    }, 1000);
  }
});

document.getElementById("home-link").addEventListener("click", (e) => {
  e.preventDefault();
  setTimeout(() => {
    startOver();
    document.getElementById("topic-zone").style.display = "block";
    document.getElementById("question-zone").style.display = "none";
    document.getElementById("result-zone").style.display = "none";
  }, 200);
});
